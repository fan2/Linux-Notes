
[字符串操作 ${} 的截取，删除和替换](https://www.jianshu.com/p/2305fc9351c2)

[Shell脚本中替换字符串等操作](https://blog.csdn.net/jeffiny/article/details/83271889)

expr    | note
--------|--------
`${string/substring/replacement}`  | 使用 $replacement, 代替第一个匹配的 $substring
`${string//substring/replacement}` | 使用 $replacement, 代替所有匹配的 $substring
`${string/#substring/replacement}` | 如果 $string 的前缀匹配 $substring, 那么就用 $replacement 来代替匹配到的 $substring
`${string/%substring/replacement}` | 如果 $string 的后缀匹配 $substring, 那么就用 $replacement 来代替匹配到的 $substring

## 普通替换

`${string/match_string/replace_string}`: 将 string 中第一个 match_string 替换成 replace_string；  
`${string//match_string/replace_string}`: 将 string 中的 match_string 全部替换成 replace_string；  

```
$ str=123abc123
$ echo "${str/123/r}"
rabc123
$ echo "${str//123/r}"
rabcr
```

将 `2905558360/FileRecv` 中的 / 替换为 -；

```
> str='2905558360/FileRecv'
> echo $str
2905558360/FileRecv

> echo "${str/\//-}"
2905558360-FileRecv
```

## 前后缀替换

`${string/#match_string/replace_string}`: 将 string 中第一个 match_string 替换成 replace_string  
`${string/%match_string/replace_string}`: 将 string 中最后一个 match_string 替换成 replace_string  

```
$ str=123abc123
$ echo "${str/#123/r}"
rabc123
$ echo "${str/%123/r}"
123abcr
```

### demo

doc_subdir 字符串值为 "2015952713/FileRecv" 或 "/2015952713/FileRecv/"，如果是后者需要移除首尾的 `/`：

1. 去掉开头的 `/` 两种方法：

- 截左留右：`sub_dir=${sub_dir#/}`;  
- 前缀替换为空：`sub_dir=${sub_dir/#\//}`;  

2. 去掉结尾的 `/` 两种方法：

- 截右留左：`sub_dir=${sub_dir%/}`;  
- 后缀替换为空：`sub_dir=${sub_dir/%\//}`;  

```Shell
    sub_dir=$doc_subdir
    if [ ${sub_dir:0:1} = "/" ]   # 去掉开头的 /
    then
        sub_dir=${sub_dir#/} # sub_dir=${sub_dir/#\//}
    fi
    if [ ${sub_dir:0-1:1} = "/" ] # 去掉结尾的 /
    then
        sub_dir=${sub_dir%/} # sub_dir=${sub_dir/%\//}
    fi
    
    sub_folder="/Documents/$sub_dir/" # 拼接沙盒路径
```

移除首尾的 `/` 后，要生成临时文件名，中间的 `/` 需要全部替换为 `-`：

```Shell
    file_name=${sub_dir//\//-} # 替换 / 为 -
    ls_out_file="./ios-deploy-list-Documents-$file_name.txt"
```
